---
phase: 07-auditee-portal-evidence
plan: 04
type: execute
wave: 2
depends_on: [07-03]
files_modified:
  - src/components/auditee/deadline-badge.tsx
  - src/components/auditee/observation-list.tsx
  - src/components/auditee/observation-card.tsx
  - src/components/auditee/overdue-banner.tsx
autonomous: true

must_haves:
  truths:
    - "Deadline badge shows color-coded countdown: >7d normal, 3-7d amber, 1-3d orange, <24h red, overdue red bg (AUD-06)"
    - "Observation list is filterable by status (pending response, awaiting review, all)"
    - "Observation card shows title, severity badge, status, deadline badge, branch name (AUD-07)"
    - "Overdue banner appears at top of page when overdue items exist"
  artifacts:
    - path: src/components/auditee/deadline-badge.tsx
      provides: Color-coded deadline countdown component
      min_lines: 30
      contains: "DeadlineBadge"
    - path: src/components/auditee/observation-list.tsx
      provides: Filterable observation list for auditee portal
      min_lines: 50
      contains: "ObservationList"
    - path: src/components/auditee/observation-card.tsx
      provides: Observation summary card with deadline and severity
      min_lines: 40
      contains: "ObservationCard"
    - path: src/components/auditee/overdue-banner.tsx
      provides: Alert banner for overdue observations
      min_lines: 15
      contains: "OverdueBanner"
  key_links:
    - from: observation-card.tsx
      to: deadline-badge.tsx
      via: Renders DeadlineBadge with dueDate
      pattern: "DeadlineBadge"
    - from: observation-list.tsx
      to: observation-card.tsx
      via: Maps observations to cards
      pattern: "ObservationCard"
---

<objective>
Create the core UI components for the auditee observation list: deadline countdown badge, observation cards with severity/status, filterable list, and overdue alert banner.

Purpose: These components form the auditee's primary view of their assigned observations. The deadline badge provides at-a-glance urgency indicators (AUD-06), observation cards summarize each finding (AUD-07), and the overdue banner catches attention for missed deadlines.

Output: Four auditee components in `src/components/auditee/`.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-auditee-portal-evidence/07-PLAN.md
@src/lib/constants.ts
@src/lib/utils.ts
@src/lib/icons.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create deadline badge and overdue banner</name>
  <files>src/components/auditee/deadline-badge.tsx, src/components/auditee/overdue-banner.tsx</files>
  <action>
**1. deadline-badge.tsx** — Client component ('use client'):

Props: `dueDate: Date | string | null`

Countdown logic:

- Calculate `daysRemaining = Math.ceil((dueDate - now) / (1000 * 60 * 60 * 24))`
- Visual states:
  - `> 7 days`: Muted text, no badge color → "X days remaining"
  - `3-7 days`: Amber badge → "X days remaining"
  - `1-3 days`: Orange badge → "X days remaining"
  - `< 24 hours`: Red badge with pulse animation → "Due today" or "Due tomorrow"
  - `Overdue`: Red background → "X days overdue"
  - `No due date`: Gray text → "No deadline"
- Use shadcn Badge component with variant overrides
- Client component because countdown needs real-time calculation

**2. overdue-banner.tsx** — Server or client component:

Props: `overdueCount: number`

- If overdueCount === 0, render nothing
- Otherwise, render Alert/banner with red/amber styling:
  - Icon: AlertTriangle
  - Text: "You have {count} overdue observation(s) requiring immediate attention"
- Use shadcn Alert component with destructive variant
  </action>
  <verify>Run `pnpm build` to confirm TypeScript compilation. Verify DeadlineBadge handles all 6 visual states. Verify OverdueBanner hides when count is 0.</verify>
  <done>DeadlineBadge shows color-coded countdown for 6 urgency levels. OverdueBanner conditionally renders overdue alert.</done>
  </task>

<task type="auto">
  <name>Task 2: Create observation card and list</name>
  <files>src/components/auditee/observation-card.tsx, src/components/auditee/observation-list.tsx</files>
  <action>
**1. observation-card.tsx** — Client component:

Props: observation object (id, title, severity, status, dueDate, branch.name, auditArea.name)

Layout:

- Card with hover effect and click handler (navigates to detail page)
- Top row: title (truncated), severity badge (SEVERITY_COLORS)
- Middle row: branch name, audit area name
- Bottom row: status badge (OBSERVATION_STATUS_COLORS), DeadlineBadge
- Overdue observations get red left border accent
- Use shadcn Card component with standard patterns

**2. observation-list.tsx** — Client component:

Props: `observations: Observation[]`, `nextCursor?: string`

Features:

- Filter tabs at top: "All", "Pending Response" (ISSUED status), "Awaiting Review" (RESPONSE status), "Closed" (CLOSED status)
- Sort: by deadline (default), by severity, by date created
- Renders ObservationCard for each observation
- Load more button when nextCursor exists (calls `getObservationsForAuditee` with cursor)
- Empty state: "No observations found" with appropriate messaging per filter
- Uses shadcn Tabs component for filters
  </action>
  <verify>Run `pnpm build` to confirm TypeScript compilation. Verify ObservationCard renders all required fields. Verify ObservationList has filter tabs and load more.</verify>
  <done>ObservationCard displays observation summary with severity, status, and deadline. ObservationList provides filterable view with cursor-based pagination.</done>
  </task>

</tasks>

<verification>
1. `pnpm build` succeeds
2. DeadlineBadge handles: >7d, 3-7d, 1-3d, <24h, overdue, no deadline
3. OverdueBanner renders nothing when count is 0
4. ObservationCard shows title, severity, status, deadline, branch
5. ObservationList has filter tabs for status categories
6. ObservationList supports load-more with cursor pagination
</verification>

<success_criteria>

- Deadline countdown is visually distinct for each urgency level (AUD-06)
- Overdue items are highlighted with banner and card accent (AUD-07)
- Observation cards show all key metadata at a glance
- Filter tabs let auditee focus on actionable items (pending response)
- Cursor-based pagination handles large observation lists
  </success_criteria>

<output>
After completion, create `.planning/phases/07-auditee-portal-evidence/07-04-SUMMARY.md`
</output>
