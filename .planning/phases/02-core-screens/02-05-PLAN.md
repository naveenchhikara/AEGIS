---
phase: 02-core-screens
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/layout/top-bar.tsx
  - src/app/(dashboard)/layout.tsx
  - src/components/ui/sidebar.tsx
autonomous: true

must_haves:
  truths:
    - "Top bar shows user profile dropdown, language switcher, and notifications bell"
    - "Sidebar collapses to hamburger menu on mobile"
    - "Layout is responsive across desktop, tablet, and mobile"
    - "Navigation between screens works without page refresh"
  artifacts:
    - path: "src/components/layout/top-bar.tsx"
      provides: "Enhanced top bar with responsive behavior"
      exports: ["TopBar"]
    - path: "src/app/(dashboard)/layout.tsx"
      provides: "Responsive dashboard layout"
  key_links:
    - from: "src/app/(dashboard)/layout.tsx"
      to: "src/components/layout/top-bar.tsx"
      via: "TopBar component import"
      pattern: "TopBar"
    - from: "src/app/(dashboard)/layout.tsx"
      to: "src/components/ui/sidebar.tsx"
      via: "SidebarProvider with mobile support"
      pattern: "SidebarProvider"
---

<objective>
Enhance the layout for responsive behavior: ensure the sidebar collapses to a hamburger menu on mobile, the top bar adapts to small screens, and loading/empty state patterns are established.

Purpose: These changes fulfill NAV-02 and NAV-03 requirements. The sidebar already uses shadcn's collapsible="icon" but needs mobile-specific behavior testing and polishing.
Output: Updated layout and top bar components with verified responsive behavior.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/app/(dashboard)/layout.tsx
@src/components/layout/top-bar.tsx
@src/components/layout/app-sidebar.tsx
@src/components/ui/sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Responsive layout and top bar enhancements</name>
  <files>
    src/components/layout/top-bar.tsx
    src/app/(dashboard)/layout.tsx
  </files>
  <action>
    **TopBar enhancements (NAV-02 completion):**
    The top bar already has language switcher, notifications bell, and user avatar dropdown. Enhance for mobile:

    1. On mobile (< md breakpoint), hide the bank name text to save space. Use a responsive class: `className="hidden md:block ..."` on the bank name h2 element.
    2. Ensure the notification bell, language switcher, and user avatar remain visible on all screen sizes.
    3. Add a notification count badge: the existing red dot is good, but add an aria-label with count for accessibility: `aria-label="3 notifications"` (hardcoded for prototype).
    4. Verify the existing SidebarTrigger button is visible on mobile — this is the hamburger menu trigger. The shadcn sidebar component handles this automatically via the `SidebarTrigger` component.

    **Layout enhancements (NAV-03):**
    The current layout.tsx is:
    ```
    SidebarProvider > AppSidebar + SidebarInset > TopBar + main
    ```

    1. Verify that `SidebarProvider` correctly handles mobile behavior. The shadcn sidebar component with `collapsible="icon"` already supports:
       - On desktop: sidebar collapses to icon-only rail
       - On mobile: sidebar becomes a Sheet overlay triggered by SidebarTrigger
    2. The main content area needs proper mobile padding. Update the `<div className="flex-1 overflow-auto p-6">` to use responsive padding: `p-4 md:p-6`
    3. Add a Suspense boundary around the children for loading states (Success Criteria #20):
       ```tsx
       import { Suspense } from 'react';
       // In the layout:
       <Suspense fallback={<PageLoadingSkeleton />}>
         {children}
       </Suspense>
       ```
    4. Create an inline PageLoadingSkeleton component (or in the same file) that renders:
       - A header skeleton (Skeleton h-8 w-48)
       - A subtitle skeleton (Skeleton h-4 w-64)
       - A grid of 4 card skeletons (Skeleton h-24)
       This provides loading states during navigation (Success Criteria #20).

    Key: The shadcn sidebar already handles mobile drawer behavior via Sheet component internally. The SidebarTrigger shows as a hamburger icon on mobile. Verify this works by checking the sidebar.tsx component's mobile detection logic (it uses `useIsMobile()` hook internally).

    Do NOT break existing functionality. The sidebar, navigation, and top bar already work — this task is about polishing responsive behavior and adding loading states.
  </action>
  <verify>
    - `pnpm build` passes
    - TopBar hides bank name on small screens (check for `hidden md:block` class)
    - Layout has responsive padding (p-4 md:p-6)
    - Suspense boundary wraps children with skeleton fallback
    - SidebarTrigger remains visible on all screen sizes
  </verify>
  <done>
    - NAV-02: Top bar shows profile dropdown, language switcher, notifications (already done, now polished)
    - NAV-03: Sidebar collapses to hamburger on mobile (shadcn built-in, now verified)
    - Loading skeleton shows during page transitions
    - Responsive padding on main content area
  </done>
</task>

</tasks>

<verification>
- `pnpm build` passes
- Layout responsive: bank name hidden on mobile, padding adjusts
- Loading skeleton component exists
- No regression in existing sidebar/topbar functionality
</verification>

<success_criteria>
- NAV-02: Top bar displays user profile dropdown, language switcher, and notifications bell on all screen sizes
- NAV-03: Sidebar collapses to hamburger menu on mobile (Sheet overlay)
- Loading states show during navigation transitions
- Layout padding is responsive (p-4 on mobile, p-6 on desktop)
- No TypeScript errors, project builds cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-screens/02-05-SUMMARY.md`
</output>
