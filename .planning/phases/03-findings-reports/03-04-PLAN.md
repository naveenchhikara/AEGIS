---
phase: 03-findings-reports
plan: 04
type: execute
wave: 2
depends_on: ["03-01", "03-02"]
files_modified:
  - src/app/(dashboard)/findings/[id]/page.tsx
  - src/components/findings/finding-detail.tsx
autonomous: false

must_haves:
  truths:
    - Finding detail page displays all finding fields
    - All fields show: observation, root cause, risk impact, auditee response, action plan, evidence
    - Timeline view displays status history with dates and actors
    - Severity badge shows correct color
    - Page navigates correctly from findings list
    - Back button returns to findings list
  artifacts:
    - path: "src/app/(dashboard)/findings/[id]/page.tsx"
      provides: "Finding detail page with dynamic route"
      exports: ["default"]
    - path: "src/components/findings/finding-detail.tsx"
      provides: "Finding detail content component"
      exports: ["FindingDetail"]
  key_links:
    - from: "src/app/(dashboard)/findings/[id]/page.tsx"
      to: "src/data/findings.json"
      via: "finding lookup by id"
      pattern: "findings\\.find.*id"
    - from: "src/components/findings/finding-detail.tsx"
      to: "src/components/findings/severity-badge.tsx"
      via: "import { SeverityBadge }"
      pattern: "SeverityBadge"
    - from: "src/components/findings/finding-detail.tsx"
      to: "src/components/findings/status-timeline.tsx"
      via: "import { StatusTimeline }"
      pattern: "StatusTimeline"
    - from: "src/app/(dashboard)/findings/[id]/page.tsx"
      to: "src/app/(dashboard)/findings/page.tsx"
      via: "router.back or Link"
      pattern: "router\\.back|href.*findings"
---

<objective>
Build finding detail page with all fields and status timeline.

Purpose: Create the detailed view for individual findings showing observation, root cause, risk impact, auditee response, action plan, evidence attachments, and a chronological timeline of status changes. This implements FIND-05 and FIND-06 requirements.

Output: Finding detail page with complete information and timeline
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-findings-reports/03-RESEARCH.md
@.planning/phases/03-findings-reports/03-01-SUMMARY.md
@.planning/phases/03-findings-reports/03-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FindingDetail component</name>
  <files>src/components/findings/finding-detail.tsx</files>
  <action>
    Create finding-detail.tsx with:
    1. Import Card, CardContent, CardHeader, CardTitle, CardDescription from "@/components/ui/card"
    2. Import Badge from "@/components/ui/badge"
    3. Import Separator from "@/components/ui/separator"
    4. Import Button from "@/components/ui/button"
    5. Import { ArrowLeft } from "lucide-react"
    6. Import SeverityBadge from "@/components/findings/severity-badge"
    7. Import StatusBadge from "@/components/findings/status-badge"
    8. Import StatusTimeline from "@/components/findings/status-timeline"
    9. Import Finding type from "@/types"
    10. Import { format } from "date-fns"

    11. Define FindingDetailProps interface: { finding: Finding, onBack: () => void }

    12. Create FindingDetail component with:
        - Header section:
          - Back button with ArrowLeft icon
          - Finding ID and title
          - Severity badge and status badge
          - Category badge
          - Assigned auditor and dates
        - Card sections using Card components:
          - Observation: Full observation text
          - Root Cause: Root cause analysis
          - Risk Impact: Risk impact description
          - Auditee Response: Response from auditee (if exists)
          - Action Plan: Planned remediation (if exists)
          - Evidence: List of evidence files (if exists, show "No evidence attached" if empty)
        - Timeline section:
          - Section title "Status History"
          - StatusTimeline component with finding.timeline
        - Use Separator between sections

    13. Export FindingDetail component

    Use "use client" directive.
    Apply proper spacing and typography for readability.
  </action>
  <verify>File exists at src/components/findings/finding-detail.tsx with FindingDetail export</verify>
  <done>FindingDetail component renders all finding fields and timeline</done>
</task>

<task type="auto">
  <name>Task 2: Create finding detail page with dynamic route</name>
  <files>src/app/(dashboard)/findings/[id]/page.tsx</files>
  <action>
    Create src/app/(dashboard)/findings/[id]/ directory structure.

    Create page.tsx with:
    1. Import { notFound } from "next/navigation"
    2. Import findings from "@/data/findings.json"
    3. Import Finding type from "@/types"
    4. Import FindingDetail from "@/components/findings/finding-detail"
    5. Import { useRouter } from "next/navigation"

    6. Define PageProps interface: { params: Promise<{ id: string }> }

    7. Create default async page component:
       - Await params to get id
       - Find finding by id in findings array
       - If not found, call notFound()
       - Get router for back navigation
       - Render page layout with container
       - Render FindingDetail with finding and onBack handler (router.back or router.push('/findings'))
       - Include proper error handling for invalid IDs

    8. Export default page component

    This is a server component that fetches data and renders the client-side FindingDetail component.
    Handle case sensitivity for finding IDs (convert to uppercase for matching).
  </action>
  <verify>File exists at src/app/(dashboard)/findings/[id]/page.tsx with default export</verify>
  <done>Finding detail page loads for valid finding IDs, shows 404 for invalid IDs</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Finding detail page with complete information display and timeline</what-built>
  <how-to-verify>
    1. Start dev server: npm run dev
    2. Navigate to findings list: http://localhost:3000/findings
    3. Click on any finding row
    4. Verify detail page loads with:
       - Finding ID and title in header
       - Severity badge with correct color
       - Status badge
       - All field sections: Observation, Root Cause, Risk Impact
       - Auditee Response (if present for this finding)
       - Action Plan (if present for this finding)
       - Evidence list or "No evidence attached" message
       - Status History section with timeline entries
    5. Verify timeline shows dates, actors, and actions
    6. Click back button to return to findings list
    7. Try navigating to http://localhost:3000/findings/FIND-999 (invalid ID)
    8. Verify 404 page is shown
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
- FindingDetail component renders all sections
- Fields render conditionally (auditee response, action plan, evidence)
- Timeline displays with chronological entries
- Back button navigation works
- Dynamic route handles valid and invalid IDs
- Page uses correct layout and spacing
- Typography is readable and well-formatted
</verification>

<success_criteria>
- FIND-04: Click on finding opens detail page
- FIND-05: Finding detail shows all required fields
- FIND-06: Timeline view displays status history
- 404 handling for invalid finding IDs
- Back navigation returns to list
</success_criteria>

<output>
After completion, create `.planning/phases/03-findings-reports/03-04-SUMMARY.md`
</output>
