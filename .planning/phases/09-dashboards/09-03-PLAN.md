---
phase: 09-dashboards
plan: 03
type: execute
wave: 2
depends_on: [09-01, 09-02]
files_modified:
  - src/components/dashboard/widgets/health-score-gauge.tsx
  - src/components/dashboard/widgets/compliance-status-chart.tsx
  - src/components/dashboard/widgets/audit-coverage-chart.tsx
  - src/components/dashboard/widgets/observation-severity-cards.tsx
  - src/components/dashboard/widgets/finding-aging-chart.tsx
  - src/components/dashboard/widgets/daksh-score-gauge.tsx
  - src/components/dashboard/widgets/executive-kpis.tsx
autonomous: true

must_haves:
  truths:
    - "All shared widgets accept data via props (not JSON imports)"
    - "Health score gauge renders radial gauge with 0-100 score and color bands"
    - "Compliance status chart renders donut with Compliant/Partial/Non-Compliant/Pending segments"
    - "Audit coverage chart renders donut with covered/uncovered branch counts"
    - "Observation severity cards show Critical/High/Medium/Low count cards with color coding"
    - "Finding aging chart renders stacked bar with 5 aging buckets (current, 0-30, 31-60, 61-90, 90+)"
    - "DAKSH score gauge handles null with 'Not yet assessed' display"
    - "Executive KPIs show 4 cards: total observations, closure rate, compliance %, coverage %"
  artifacts:
    - path: src/components/dashboard/widgets/health-score-gauge.tsx
      provides: Radial gauge for composite health score (0-100)
      min_lines: 40
      contains: "HealthScoreGauge"
    - path: src/components/dashboard/widgets/compliance-status-chart.tsx
      provides: Donut chart of compliance statuses
      min_lines: 30
      contains: "ComplianceStatusChart"
    - path: src/components/dashboard/widgets/finding-aging-chart.tsx
      provides: Stacked bar chart for observation aging buckets
      min_lines: 40
      contains: "FindingAgingChart"
    - path: src/components/dashboard/widgets/executive-kpis.tsx
      provides: Row of 4 KPI cards for executive dashboard
      min_lines: 30
      contains: "ExecutiveKpis"
  key_links:
    - from: All widgets
      to: src/data-access/dashboard.ts
      via: Data passed as props from dashboard page (SSR) or React Query (polling)
      pattern: "props"
    - from: Chart widgets
      to: recharts
      via: Recharts components for data visualization
      pattern: "ResponsiveContainer"
---

<objective>
Build the 7 shared dashboard widgets that appear across multiple role dashboards: health score gauge, compliance chart, coverage chart, severity cards, aging chart, DAKSH gauge, and executive KPIs.

Purpose: These widgets are reused across CAE, CCO, CEO, and Manager dashboards (DRY). Each accepts data via props (from SSR or React Query polling). They replace the existing JSON-based dashboard widgets with real data-driven versions.

Output: 7 shared widget components.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-dashboards/09-PLAN.md
@src/components/dashboard/
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create health score, compliance, and coverage chart widgets</name>
  <files>src/components/dashboard/widgets/health-score-gauge.tsx, src/components/dashboard/widgets/compliance-status-chart.tsx, src/components/dashboard/widgets/audit-coverage-chart.tsx</files>
  <action>
**1. health-score-gauge.tsx:**

Radial gauge displaying composite health score:

- Props: `score: number` (0-100), `size?: 'default' | 'large'`
- Recharts RadialBarChart with single bar
- Color bands: 0-40 red, 41-60 amber, 61-80 yellow-green, 81-100 green
- Center text showing score number
- EmptyStateCard fallback when score is 0 with "Complete onboarding to start tracking"
- Used by: CAE, CEO dashboards

**2. compliance-status-chart.tsx:**

Donut chart of compliance statuses:

- Props: `data: { compliant: number; partial: number; nonCompliant: number; pending: number }`
- Recharts PieChart with 4 segments (green, amber, red, gray)
- Center text: compliance percentage
- Legend below chart
- EmptyStateCard when total = 0 with link to /compliance
- Used by: CAE, CCO, CEO dashboards

**3. audit-coverage-chart.tsx:**

Donut chart of branch audit coverage:

- Props: `data: { coveredCount: number; totalCount: number; percentage: number }`
- Recharts PieChart with 2 segments (covered = green, uncovered = gray)
- Center text: "N/M branches" + percentage
- EmptyStateCard when totalCount = 0 with link to /audit-plans
- Used by: CAE, CEO, Manager dashboards
  </action>
  <verify>Run `pnpm build`. Verify all 3 charts accept typed props. Verify empty state handling. Verify `pointer-events-none` on center text overlays (Recharts tooltip fix).</verify>
  <done>Health score gauge, compliance status chart, and audit coverage chart shared widgets.</done>
  </task>

<task type="auto">
  <name>Task 2: Create severity cards, aging chart, DAKSH gauge, and KPIs</name>
  <files>src/components/dashboard/widgets/observation-severity-cards.tsx, src/components/dashboard/widgets/finding-aging-chart.tsx, src/components/dashboard/widgets/daksh-score-gauge.tsx, src/components/dashboard/widgets/executive-kpis.tsx</files>
  <action>
**1. observation-severity-cards.tsx:**

4 KPI cards for severity distribution:

- Props: `data: { criticalOpen: number; highOpen: number; mediumOpen: number; lowOpen: number }`
- 4 cards in a row: Critical (red), High (orange), Medium (yellow), Low (green)
- Each shows count + label
- Used by: Manager, CAE, CEO dashboards

**2. finding-aging-chart.tsx:**

Stacked bar chart for observation aging:

- Props: `data: { current: number; bucket030: number; bucket3160: number; bucket6190: number; bucket90Plus: number }`
- Recharts StackedBarChart or horizontal bar
- 5 segments with aging bucket colors (green → dark red)
- Legend with bucket labels
- If all zero: green checkmark + "All findings on track"
- Used by: Manager, CAE dashboards

**3. daksh-score-gauge.tsx:**

DAKSH supervisory score display:

- Props: `score: number | null`
- If null: gray badge "Not yet assessed"
- If number: radial gauge with RBI color bands
- Small size, fits in 1/3 width card
- Used by: CAE, CEO dashboards

**4. executive-kpis.tsx:**

Row of 4 KPI cards for executive overview:

- Props: `data: { totalObservations: number; closureRate: number; compliancePercentage: number; coveragePercentage: number }`
- 4 cards: Total Observations, Closure Rate (%), Compliance (%), Coverage (%)
- Each card has icon, value, and trend indicator (up/down arrow if previous period data available)
- Used by: CAE, CEO dashboards
  </action>
  <verify>Run `pnpm build`. Verify severity cards show 4 color-coded cards. Verify aging chart handles all-zero case. Verify DAKSH gauge handles null. Verify KPIs display 4 metrics.</verify>
  <done>Observation severity cards, finding aging chart, DAKSH score gauge, and executive KPI cards.</done>
  </task>

</tasks>

<verification>
1. `pnpm build` succeeds
2. All 7 widgets accept data via typed props (not JSON imports)
3. Health score gauge shows color bands (red/amber/green)
4. Compliance chart shows 4-segment donut with percentage center
5. Audit coverage chart shows covered/uncovered with percentage
6. Severity cards show 4 color-coded count cards
7. Aging chart shows 5 bucket stacked bar
8. DAKSH gauge handles null gracefully
9. Executive KPIs display 4 metric cards
10. All charts use `pointer-events-none` on center overlays
</verification>

<success_criteria>

- 7 shared widgets ready for composition into role dashboards
- All widgets handle empty/zero data gracefully with EmptyStateCard
- Recharts charts render correctly with typed props
- Widgets are DRY — used across multiple role dashboards (DASH-03, DASH-04, DASH-05)
  </success_criteria>

<output>
After completion, create `.planning/phases/09-dashboards/09-03-SUMMARY.md`
</output>
