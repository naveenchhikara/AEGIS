---
phase: 02-core-screens
plan: 04
type: execute
wave: 3
depends_on: [02-01]
files_modified:
  - src/components/audits/audit-calendar.tsx
  - src/components/audits/audit-card.tsx
  - src/components/audits/audit-filter-bar.tsx
autonomous: false

must_haves:
  truths:
    - Calendar view shows all planned audits by month
    - Calendar events are clickable and open audit details
    - Audit events display with correct colors by status (gray/blue/orange/green)
    - Engagement cards display: audit name, branch/department, dates, team, status, progress
    - Filter by audit type works correctly (Branch, IS, Credit, Compliance, Revenue)
    - Progress bars show engagement completion percentage
    - Calendar uses react-big-calendar with proper styling
  artifacts:
    - path: "src/components/audits/audit-calendar.tsx"
      provides: "Calendar view of audit plan with event styling"
      exports: ["AuditCalendar"]
      contains: "react-big-calendar with custom event styles"
    - path: "src/components/audits/audit-card.tsx"
      provides: "Engagement card with audit details and progress"
      exports: ["AuditEngagementCard"]
      contains: "audit info, team, progress bar, status badge"
    - path: "src/components/audits/audit-filter-bar.tsx"
      provides: "Filter controls for audit type"
      exports: ["AuditFilterBar"]
      contains: "audit type dropdown with URL state"
  key_links:
    - from: "src/components/audits/audit-calendar.tsx"
      to: "react-big-calendar"
      via: "Calendar import with localizer"
      pattern: "Calendar.*localizer.*momentLocalizer"
    - from: "src/components/audits/audit-calendar.tsx"
      to: "date-fns or moment"
      via: "localizer setup"
      pattern: "momentLocalizer|localizer"
    - from: "src/components/audits/audit-card.tsx"
      to: "@/data/audit-plans"
      via: "audit data import"
      pattern: "auditPlans"
    - from: "src/components/audits/audit-filter-bar.tsx"
      to: "next/navigation"
      via: "useSearchParams hook"
      pattern: "useSearchParams"
    - from: "src/components/audits/audit-card.tsx"
      to: "@/lib/status-utils"
      via: "AuditStatusBadge import"
      pattern: "AuditStatusBadge"
---

<objective>
Build audit plan components: calendar view with event styling, engagement cards, and type filter.

Purpose: Create the audit plan screen components per AUDT-01 through AUDT-05 requirements. Calendar uses react-big-calendar for monthly view, cards show engagement details with progress, and filter enables type-based filtering with URL state.

Output: Audit plan components ready for page composition
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-core-screens/02-RESEARCH.md
@.planning/phases/02-core-screens/02-01-SUMMARY.md
@.planning/phases/01-project-setup/01-09-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create audit calendar component</name>
  <files>src/components/audits/audit-calendar.tsx</files>
  <action>
    Create src/components/audits/ directory and audit-calendar.tsx:

    Add "use client" directive.

    Import: Calendar, momentLocalizer from 'react-big-calendar', moment from 'moment', 'react-big-calendar/lib/css/react-big-calendar.css', type AuditPlan from '@/types

    Component features:
    - Props: audits, onAuditClick
    - Initialize localizer: momentLocalizer(moment)
    - Transform audits to calendar events:
      * id: audit.id
      * title: audit.name
      * start: new Date(audit.plannedStartDate)
      * end: new Date(audit.plannedEndDate)
      * resource: audit (full object for click handler)
    - eventStyleGetter function: colors by status
      * not-started: #6b7280 (gray)
      * in-progress: #3b82f6 (blue)
      * on-hold: #f97316 (orange)
      * complete: #10b981 (green)
    - Calendar props:
      * localizer, events, startAccessor="start", endAccessor="end"
      * eventPropGetter for styling
      * onSelectEvent calls onAuditClick with event.resource
      * views={['month', 'week', 'day']}, defaultView="month"
      * style={{ height: 600px }}

    Note: Per RESEARCH.md, dates in English for prototype (i18n in Phase 4).

    Export: AuditCalendar component
  </action>
  <verify>Component imports react-big-calendar CSS and uses momentLocalizer</verify>
  <done>Audit calendar created with event styling by status</done>
</task>

<task type="auto">
  <name>Task 2: Create audit engagement card</name>
  <files>src/components/audits/audit-card.tsx</files>
  <action>
    Create src/components/audits/audit-card.tsx:

    Add "use client" directive.

    Import: Card, CardContent, CardHeader, CardTitle from @/components/ui/card, Badge from @/components/ui/badge, Progress from @/components/ui/progress, Calendar, Users icons from lucide-react, type AuditPlan from '@/types, AuditStatusBadge from @/lib/status-utils

    Component features:
    - Props: audit, onClick
    - formatDate helper: returns "Mon DD" format
    - Card sections:
      * Header: audit.name (CardTitle), AuditStatusBadge(audit.status)
      * Dates: Calendar icon + formatted start-end date range
      * Team: Users icon + team member count
      * Progress: Progress bar with percentage and label
      * Branches/Departments: Badges (max 3 shown, +N more for overflow)
    - Hover effect: hover:shadow-md transition-shadow
    - Cursor pointer for click affordance
    - Click handler: calls onClick(audit)

    Per RESEARCH.md code example for audit engagement card.

    Export: AuditEngagementCard component
  </action>
  <verify>Component displays audit info with progress bar and status badge</verify>
  <done>Audit engagement card created with progress visualization</done>
</task>

<task type="auto">
  <name>Task 3: Create audit filter bar</name>
  <files>src/components/audits/audit-filter-bar.tsx</files>
  <action>
    Create src/components/audits/audit-filter-bar.tsx:

    Add "use client" directive.

    Import: useSearchParams from 'next/navigation', Select, SelectContent, SelectItem, SelectTrigger, SelectValue from @/components/ui/select

    Component features:
    - Read type filter from useSearchParams()
    - Define audit type options:
      * all - "All Audit Types"
      * branch-audit - "Branch Audit"
      * is-audit - "IS Audit"
      * credit-audit - "Credit Audit"
      * compliance-audit - "Compliance Audit"
      * revenue-audit - "Revenue Audit"
    - updateFilter function: uses URLSearchParams to update URL
    - Select component: displays current filter, calls updateFilter on change
    - Filter value resets to 'all' to show all audits

    Use same URL-based pattern as compliance filter bar.

    Export: AuditFilterBar component
  </action>
  <verify>Component uses useSearchParams and updates URL on filter change</verify>
  <done>Audit filter bar created with type selection and URL state</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Audit plan components: calendar view, engagement cards, filter bar</what-built>
  <how-to-verify>
    Note: Components are created but not yet rendered on page. This checkpoint verifies component structure.

    1. Check all component files exist in src/components/audits/
    2. Verify TypeScript compiles: npx tsc --noEmit
    3. Check component exports:
       - audit-calendar.tsx exports AuditCalendar
       - audit-card.tsx exports AuditEngagementCard
       - audit-filter-bar.tsx exports AuditFilterBar

    Components should:
    - All have "use client" directive
    - Calendar imports react-big-calendar CSS
    - Calendar uses momentLocalizer for date handling
    - Calendar eventStyleGetter colors events by status
    - Card displays progress with Progress component
    - Card uses AuditStatusBadge for consistent colors
    - Filter bar uses useSearchParams for URL state
  </how-to-verify>
  <resume-signal>Type "approved" if all audit components are created and compile, or describe issues</resume-signal>
</task>

</tasks>

<verification>
- All 3 component files exist in src/components/audits/
- AuditCalendar uses react-big-calendar with momentLocalizer
- Calendar imports CSS for proper styling
- eventStyleGetter colors events by status
- AuditEngagementCard shows progress bar with percentage
- Card uses AuditStatusBadge for consistent status colors
- AuditFilterBar uses useSearchParams for URL-based filtering
- TypeScript compiles without errors
</verification>

<success_criteria>
- 3 audit plan components created
- Calendar displays audit events with correct colors
- Engagement cards show all required fields (name, dates, team, progress)
- Filter bar enables type-based filtering
- URL-based state management for filters
- All components connect to AuditPlan types
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-screens/02-04-SUMMARY.md`
</output>
