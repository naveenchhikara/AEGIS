---
phase: 03-findings-reports
plan: 05
type: execute
wave: 3
depends_on: ["03-01", "03-02"]
files_modified:
  - src/app/(dashboard)/audits/page.tsx
  - src/app/(dashboard)/audits/[id]/page.tsx
  - src/components/audits/audit-workspace.tsx
  - src/components/audits/audit-engagement-card.tsx
autonomous: false

must_haves:
  truths:
    - Audit engagement workspace renders with tabbed interface
    - Engagement cards show audit name, branch/department, dates, team, status, progress
    - Status indicators show correct colors (Not Started=gray, In Progress=blue, On Hold=orange, Complete=green)
    - Progress bars display completion percentage
    - Filter by audit type works correctly
    - Audit program linkages display in workspace
  artifacts:
    - path: "src/app/(dashboard)/audits/page.tsx"
      provides: "Audit plan list page"
      exports: ["default"]
    - path: "src/app/(dashboard)/audits/[id]/page.tsx"
      provides: "Audit engagement detail page"
      exports: ["default"]
    - path: "src/components/audits/audit-workspace.tsx"
      provides: "Tabbed workspace for audit details"
      exports: ["AuditWorkspace"]
    - path: "src/components/audits/audit-engagement-card.tsx"
      provides: "Card component for audit engagement display"
      exports: ["AuditEngagementCard"]
  key_links:
    - from: "src/app/(dashboard)/audits/page.tsx"
      to: "src/data/audits.json"
      via: "import audits"
      pattern: "import.*audits.*from.*@/data"
    - from: "src/components/audits/audit-engagement-card.tsx"
      to: "src/components/findings/status-badge.tsx"
      via: "import { StatusBadge }"
      pattern: "StatusBadge"
    - from: "src/components/audits/audit-engagement-card.tsx"
      to: "src/components/ui/progress"
      via: "import { Progress }"
      pattern: "Progress"
    - from: "src/app/(dashboard)/audits/[id]/page.tsx"
      to: "src/components/audits/audit-workspace.tsx"
      via: "import { AuditWorkspace }"
      pattern: "AuditWorkspace"
---

<objective>
Build audit engagement list page and workspace detail view.

Purpose: Create the audit planning screens showing engagement cards with status indicators, progress bars, and type filters. The detail page provides a tabbed workspace for audit overview, program linkages, team assignments, and related findings. This implements AUDT-01 through AUDT-06 requirements.

Output: Audit list page with cards and engagement workspace detail page
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-findings-reports/03-RESEARCH.md
@.planning/phases/03-findings-reports/03-01-SUMMARY.md
@.planning/phases/03-findings-reports/03-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AuditEngagementCard component</name>
  <files>src/components/audits/audit-engagement-card.tsx</files>
  <action>
    Create src/components/audits/ directory if not exists.

    Create audit-engagement-card.tsx with:
    1. Import Card, CardContent, CardHeader, CardTitle from "@/components/ui/card"
    2. Import Badge from "@/components/ui/badge"
    3. Import Progress from "@/components/ui/progress"
    4. Import Button from "@/components/ui/button"
    5. Import { Users, Calendar, ArrowRight } from "lucide-react"
    6. Import StatusBadge from "@/components/findings/status-badge"
    7. Import Audit type from "@/types"
    8. Import { format } from "date-fns"

    9. Define AuditEngagementCardProps interface: { audit: Audit, onClick: () => void }

    10. Create AuditEngagementCard component with:
        - Card with hover effect and cursor pointer
        - Header with audit name and type badge
        - Content section showing:
          - Branch/department name
          - Date range with Calendar icon
          - Team members with Users icon and avatar/list
          - StatusBadge for audit status
          - Progress bar with percentage label
        - Footer with "View Workspace" button and ArrowRight icon
        - Click handler (either on card or button)

    11. Style for hover interaction
    12. Export AuditEngagementCard component

    Use "use client" directive.
  </action>
  <verify>File exists at src/components/audits/audit-engagement-card.tsx with AuditEngagementCard export</verify>
  <done>AuditEngagementCard renders with all required audit information</done>
</task>

<task type="auto">
  <name>Task 2: Create AuditWorkspace component</name>
  <files>src/components/audits/audit-workspace.tsx</files>
  <action>
    Create audit-workspace.tsx with:
    1. Import Tabs, TabsContent, TabsList, TabsTrigger from "@/components/ui/tabs"
    2. Import Card, CardContent, CardHeader, CardTitle from "@/components/ui/card"
    3. Import Badge from "@/components/ui/badge"
    4. Import Progress from "@/components/ui/progress"
    5. Import Separator from "@/components/ui/separator"
    6. Import Button from "@/components/ui/button"
    7. Import { ArrowLeft, Calendar, Users, FileText, CheckCircle } from "lucide-react"
    8. Import StatusBadge from "@/components/findings/status-badge"
    9. Import Audit type from "@/types"
    10. Import { format } from "date-fns"

    11. Define AuditWorkspaceProps interface: { audit: Audit, onBack: () => void }

    12. Create AuditWorkspace component with:
        - Header section:
          - Back button with ArrowLeft icon
          - Audit name and type badge
          - StatusBadge and progress
        - Tabs with 4 tabs: Overview, Programs, Team, Findings
        - Overview tab content:
          - Audit details: dates, branch/department, status
          - Progress bar with percentage
          - Description text
        - Programs tab content:
          - List of audit programs from audit.programIds
          - Each program shows ID, name (mock), status
          - "Programs linked" header with count
        - Team tab content:
          - List of assigned team members from audit.assignedTeam
          - Each member shows name and role (mock)
          - Team size indicator
        - Findings tab content:
          - Count of findings linked to this audit (mock data from findings.json where auditId matches)
          - List of finding IDs with titles and severities
          - Link to findings detail page

    13. Export AuditWorkspace component

    Use "use client" directive.
    For Programs and Findings tabs, create mock linkage data based on IDs.
  </action>
  <verify>File exists at src/components/audits/audit-workspace.tsx with AuditWorkspace export</verify>
  <done>AuditWorkspace renders tabbed interface with all 4 tabs</done>
</task>

<task type="auto">
  <name>Task 3: Create audits list page</name>
  <files>src/app/(dashboard)/audits/page.tsx</files>
  <action>
    Create src/app/(dashboard)/audits/ directory if not exists.

    Create page.tsx with:
    1. Import audits from "@/data/audits.json"
    2. Import AuditEngagementCard from "@/components/audits/audit-engagement-card"
    3. Import { useState, useMemo } from "react"
    4. Import Select from "@/components/ui/select"
    5. Import Audit type from "@/types"
    6. Import useRouter from "next/navigation"

    7. Create page component (client component with "use client"):
       - State for audit type filter: "all" | "branch-audit" | "is-audit" | "credit-audit" | "compliance-audit" | "revenue-audit"
       - Memoized filtered audits by type
       - Handle card click: navigate to `/audits/[id]`
       - Render page header with title "Audit Plan" and count
       - Render type filter dropdown (All, Branch Audit, IS Audit, Credit Audit, Compliance Audit, Revenue Audit)
       - Render grid of AuditEngagementCard components (3 columns on lg, 2 on md, 1 on mobile)
       - Show "X of Y audits" subtitle when filtered

    8. Export default page component

    Use consistent styling with findings page.
  </action>
  <verify>File exists at src/app/(dashboard)/audits/page.tsx with default export</verify>
  <done>Audits page displays grid of engagement cards with type filter</done>
</task>

<task type="auto">
  <name>Task 4: Create audit detail page with dynamic route</name>
  <files>src/app/(dashboard)/audits/[id]/page.tsx</files>
  <action>
    Create src/app/(dashboard)/audits/[id]/ directory structure.

    Create page.tsx with:
    1. Import { notFound } from "next/navigation"
    2. Import audits from "@/data/audits.json"
    3. Import Audit type from "@/types"
    4. Import AuditWorkspace from "@/components/audits/audit-workspace"
    5. Import { useRouter } from "next/navigation"

    6. Define PageProps interface: { params: Promise<{ id: string }> }

    7. Create default async page component:
       - Await params to get id
       - Find audit by id in audits array
       - If not found, call notFound()
       - Get router for back navigation
       - Render page layout with container
       - Render AuditWorkspace with audit and onBack handler (router.back or router.push('/audits'))

    8. Export default page component

    Handle case sensitivity for audit IDs.
  </action>
  <verify>File exists at src/app/(dashboard)/audits/[id]/page.tsx with default export</verify>
  <done>Audit detail page loads for valid audit IDs, shows 404 for invalid IDs</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Audit engagement list page and workspace detail view</what-built>
  <how-to-verify>
    1. Start dev server: npm run dev
    2. Navigate to audits page: http://localhost:3000/audits
    3. Verify all 8-10 audit engagement cards display
    4. Verify status badges show correct colors (Not Started=gray, In Progress=blue, On Hold=orange, Complete=green)
    5. Verify progress bars show completion percentage
    6. Use type filter dropdown to verify filtering works
    7. Click on an audit card
    8. Verify workspace page loads with tabbed interface
    9. Click through each tab: Overview, Programs, Team, Findings
    10. Verify Programs tab shows linked audit programs
    11. Verify Team tab shows assigned team members
    12. Click back button to return to audits list
    13. Try invalid audit ID to verify 404
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
- AuditEngagementCard displays all audit information
- Status badges use correct colors per AUDT-03
- Progress bars render with correct percentage
- Type filter reduces displayed audits
- AuditWorkspace renders with 4 tabs
- All tabs display content correctly
- Back navigation works
- Dynamic route handles valid and invalid IDs
- Grid layout is responsive
</verification>

<success_criteria>
- AUDT-01: Annual plan view with engagement cards
- AUDT-02: Cards show all required fields (name, branch/department, dates, team, status)
- AUDT-03: Status indicators with correct colors
- AUDT-04: Filter by audit type works
- AUDT-05: Progress bars show completion percentage
- AUDT-06: Click opens workspace with program linkages
</success_criteria>

<output>
After completion, create `.planning/phases/03-findings-reports/03-05-SUMMARY.md`
</output>
