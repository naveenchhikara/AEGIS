---
phase: 10-onboarding-compliance
plan: 02
type: execute
wave: 1
depends_on: [10-01]
files_modified:
  - src/data/rbi-master-directions/master-directions.json
  - src/data/rbi-master-directions/checklist-items.json
  - src/data/rbi-master-directions/index.ts
  - prisma/seed-master-directions.ts
autonomous: true

must_haves:
  truths:
    - "10 Master Direction definitions in master-directions.json with shortId, title, category, rbiRef"
    - "~103 checklist items in checklist-items.json with tierApplicability arrays and tier-specific enhancements"
    - "Each checklist item has itemCode (MD-CAP-001 format), priority, frequency, evidenceRequired"
    - "Tier applicability matrix: all 10 MDs applicable to all tiers, but enhanced items for Tier 3+"
    - "Seed script populates RbiMasterDirection and RbiChecklistItem tables (global, not tenant-scoped)"
    - "Seed script maps RBI circular references where available"
    - "Barrel export in index.ts for type-safe access to template data"
  artifacts:
    - path: src/data/rbi-master-directions/master-directions.json
      provides: 10 RBI Master Direction definitions
      min_lines: 40
      contains: "MD-CAP"
    - path: src/data/rbi-master-directions/checklist-items.json
      provides: ~103 checklist items with tier applicability
      min_lines: 200
      contains: "MD-CAP-001"
    - path: prisma/seed-master-directions.ts
      provides: Database seed script for global checklist templates
      min_lines: 30
      contains: "upsert"
  key_links:
    - from: seed-master-directions.ts
      to: prisma/schema.prisma
      via: Populates RbiMasterDirection and RbiChecklistItem tables
      pattern: "createMany"
    - from: checklist-items.json
      to: master-directions.json
      via: masterDirectionId references shortId
      pattern: "masterDirectionId"
---

<objective>
Create RBI Master Direction seed data with 10 directions and ~103 checklist items, plus seed script.

Purpose: These are global templates (not tenant-specific) used during onboarding Step 3. When a bank selects their tier, the system auto-selects applicable checklist items. The seed script runs once during initial deployment to populate the template tables.

Output: 2 JSON data files, 1 barrel export, 1 seed script.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-onboarding-compliance/10-PLAN.md
@src/data/rbi-regulations/compliance-requirements.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Master Direction and checklist item data files</name>
  <files>src/data/rbi-master-directions/master-directions.json, src/data/rbi-master-directions/checklist-items.json, src/data/rbi-master-directions/index.ts</files>
  <action>
**1. master-directions.json:**

10 Master Direction definitions:

```json
[
  { "shortId": "MD-CAP", "title": "Prudential Norms on Capital Adequacy", "category": "Capital", "rbiRef": "...", "description": "..." },
  { "shortId": "MD-IRAC", "title": "Income Recognition, Asset Classification & Provisioning", "category": "Credit Risk", ... },
  { "shortId": "MD-KYC", "title": "Know Your Customer Direction", "category": "Customer Due Diligence", ... },
  { "shortId": "MD-PSL", "title": "Priority Sector Lending — Targets & Classification", "category": "Lending", ... },
  { "shortId": "MD-ADV", "title": "Management of Advances", "category": "Credit Risk", ... },
  { "shortId": "MD-BOD", "title": "Board of Directors — UCBs", "category": "Governance", ... },
  { "shortId": "MD-FRM", "title": "Fraud Risk Management", "category": "Risk Management", ... },
  { "shortId": "MD-CSF", "title": "Cyber Security Framework", "category": "IT & Cyber Security", ... },
  { "shortId": "MD-IR", "title": "Interest Rate on Deposits & Advances", "category": "Treasury", ... },
  { "shortId": "MD-INV", "title": "Investment Portfolio — Classification, Valuation & Operation", "category": "Treasury", ... }
]
```

**2. checklist-items.json:**

~103 items across 10 Master Directions. Each item:

```json
{
  "itemCode": "MD-CAP-001",
  "masterDirectionId": "MD-CAP",
  "title": "Maintain CRAR >= 12%",
  "description": "Bank must maintain Capital to Risk-weighted Assets Ratio...",
  "category": "Capital",
  "tierApplicability": ["TIER_1", "TIER_2", "TIER_3", "TIER_4"],
  "tierEnhancements": {
    "TIER_3": "Plus Capital Conservation Buffer of 2.5%",
    "TIER_4": "Plus CCB + Pillar 3 disclosures"
  },
  "frequency": "Quarterly",
  "evidenceRequired": [
    "CRAR computation sheet",
    "Risk-weighted assets schedule"
  ],
  "priority": "critical",
  "rbiCircularRef": "RBI/2024-25/09"
}
```

Item counts per MD: MD-CAP (12), MD-IRAC (15), MD-KYC (10), MD-PSL (8), MD-ADV (12), MD-BOD (10), MD-FRM (8), MD-CSF (12), MD-IR (6), MD-INV (10).

Derive from existing compliance-requirements.json (42 items) and expand with proper Master Direction categorization and tier tagging.

**3. index.ts:**

Barrel export with TypeScript types:

```typescript
import masterDirectionsData from "./master-directions.json";
import checklistItemsData from "./checklist-items.json";

export type MasterDirection = (typeof masterDirectionsData)[number];
export type ChecklistItem = (typeof checklistItemsData)[number];

export const masterDirections = masterDirectionsData;
export const checklistItems = checklistItemsData;
```

  </action>
  <verify>Run `pnpm build`. Verify 10 Master Directions in JSON. Verify ~103 checklist items with correct tier applicability arrays. Verify barrel export compiles.</verify>
  <done>10 Master Directions and ~103 checklist items with tier applicability, enhancements, and evidence requirements.</done>
</task>

<task type="auto">
  <name>Task 2: Create database seed script</name>
  <files>prisma/seed-master-directions.ts</files>
  <action>
**seed-master-directions.ts:**

Seed script to populate global RbiMasterDirection and RbiChecklistItem tables:

1. Read master-directions.json and checklist-items.json
2. For each Master Direction:
   - Upsert by shortId (idempotent — can re-run safely)
   - Set all fields from JSON
3. For each checklist item:
   - Find parent Master Direction by shortId
   - Upsert by itemCode (idempotent)
   - Set all fields including tierApplicability array
4. Log summary: "Seeded N Master Directions with M checklist items"

Use `prisma.rbiMasterDirection.upsert` and `prisma.rbiChecklistItem.upsert` for idempotency.

Add script to package.json: `"seed:master-directions": "tsx prisma/seed-master-directions.ts"`
</action>
<verify>Run `pnpm build`. Verify seed script uses upsert for idempotency. Verify it reads both JSON files and populates both tables.</verify>
<done>Idempotent seed script for RBI Master Direction templates. Ready to run after migration.</done>
</task>

</tasks>

<verification>
1. `pnpm build` succeeds
2. 10 Master Directions with correct shortIds
3. ~103 checklist items with proper tier applicability
4. Each item has itemCode, priority, frequency, evidenceRequired
5. Tier enhancements specified for Tier 3+ items
6. Seed script is idempotent (upsert by unique key)
7. Barrel export provides type-safe access
</verification>

<success_criteria>

- 10 pre-built RBI Master Direction checklists available (CMPL-01)
- Each checklist item linked to RBI circular reference (CMPL-02)
- Tier applicability matrix correctly tags enhanced items for Tier 3+
- Seed script populates global template tables (not tenant-scoped)
- Data derived from existing compliance-requirements.json + expanded
  </success_criteria>

<output>
After completion, create `.planning/phases/10-onboarding-compliance/10-02-SUMMARY.md`
</output>
