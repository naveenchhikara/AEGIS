---
phase: 02-core-screens
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/layout/top-bar.tsx
  - src/app/(dashboard)/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Top bar shows user profile dropdown, language switcher, and notifications bell on all screen sizes"
    - "Sidebar collapses to hamburger menu on mobile via shadcn SidebarTrigger"
    - "Layout is responsive across desktop, tablet, and mobile with adaptive padding"
    - "Loading skeleton shows during page transitions via Suspense boundary"
  artifacts:
    - path: "src/components/layout/top-bar.tsx"
      provides: "Enhanced top bar with responsive behavior and proper aria-labels"
      exports: ["TopBar"]
    - path: "src/app/(dashboard)/layout.tsx"
      provides: "Responsive dashboard layout with Suspense and skeleton fallback"
  key_links:
    - from: "src/app/(dashboard)/layout.tsx"
      to: "src/components/layout/top-bar.tsx"
      via: "TopBar component import"
      pattern: "TopBar"
    - from: "src/app/(dashboard)/layout.tsx"
      to: "src/components/ui/sidebar.tsx"
      via: "SidebarProvider with mobile support"
      pattern: "SidebarProvider"
---

<objective>
Enhance the layout for responsive behavior: hide bank name on mobile, add responsive padding, add Suspense boundary with loading skeleton, and ensure proper aria-labels on icon-only buttons.

Purpose: These changes fulfill NAV-02 and NAV-03 requirements. The sidebar and top bar already exist and work — this plan polishes responsive behavior and adds loading states.

Output: Updated layout and top bar components with verified responsive behavior.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/app/(dashboard)/layout.tsx
@src/components/layout/top-bar.tsx
@src/components/layout/app-sidebar.tsx
@src/components/ui/sidebar.tsx
@src/components/ui/skeleton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Responsive layout, top bar polish, and loading skeleton</name>
  <files>
    src/components/layout/top-bar.tsx
    src/app/(dashboard)/layout.tsx
  </files>
  <action>
    **TopBar enhancements (NAV-02 polish):**
    The top bar already has language switcher, notifications bell, and user avatar dropdown. Polish for mobile and accessibility:

    1. On mobile (< md), hide the bank name to save space: add `hidden md:block` to the h2 bank name element.
    2. Ensure all icon-only buttons have `aria-label`:
       - Language switcher button: `aria-label="Change language"`
       - Notifications button: already has `aria-label="Notifications"` — update to include count: `aria-label="3 notifications"`
       - User avatar button: `aria-label="User menu"`
    3. Verify SidebarTrigger is visible on all screen sizes (it already exists in the layout).
    4. Keep touch target sizes adequate: current `h-8 w-8` buttons are OK for desktop but tight on mobile. Use `min-h-[44px] min-w-[44px]` on mobile-facing interactive elements or accept 32px as sufficient for a prototype.

    Do NOT break existing functionality. This is a polish task, not a rewrite.

    **Layout enhancements (NAV-03 + loading states):**
    Update `src/app/(dashboard)/layout.tsx`:

    1. Responsive padding: Change `<div className="flex-1 overflow-auto p-6">` to `<div className="flex-1 overflow-auto p-4 md:p-6">`
    2. Add semantic main element: Wrap content area in `<main>` tag
    3. Add Suspense boundary with loading skeleton:
       ```tsx
       import { Suspense } from "react";
       import { Skeleton } from "@/components/ui/skeleton";

       function PageLoadingSkeleton() {
         return (
           <div className="space-y-6">
             <div className="space-y-2">
               <Skeleton className="h-8 w-48" />
               <Skeleton className="h-4 w-64" />
             </div>
             <div className="grid grid-cols-2 lg:grid-cols-4 gap-4">
               <Skeleton className="h-24 rounded-lg" />
               <Skeleton className="h-24 rounded-lg" />
               <Skeleton className="h-24 rounded-lg" />
               <Skeleton className="h-24 rounded-lg" />
             </div>
             <Skeleton className="h-64 rounded-lg" />
           </div>
         );
       }
       ```
    4. Wrap children in Suspense:
       ```tsx
       <main className="flex-1 overflow-auto p-4 md:p-6">
         <Suspense fallback={<PageLoadingSkeleton />}>
           {children}
         </Suspense>
       </main>
       ```

    The shadcn sidebar already handles mobile drawer behavior via internal Sheet component. SidebarTrigger automatically shows as a hamburger icon on mobile. No changes needed to sidebar.tsx or app-sidebar.tsx.
  </action>
  <verify>
    ```bash
    grep 'hidden md:block' src/components/layout/top-bar.tsx
    grep 'p-4 md:p-6' src/app/\(dashboard\)/layout.tsx
    grep 'Suspense' src/app/\(dashboard\)/layout.tsx
    grep 'PageLoadingSkeleton' src/app/\(dashboard\)/layout.tsx
    grep '<main' src/app/\(dashboard\)/layout.tsx
    pnpm build
    ```
  </verify>
  <done>
    - NAV-02: Top bar shows profile dropdown, language switcher, notifications with proper aria-labels
    - NAV-03: Sidebar collapses to hamburger on mobile (shadcn built-in, verified)
    - Bank name hidden on mobile screens
    - Loading skeleton shows during page transitions
    - Responsive padding: p-4 on mobile, p-6 on desktop
    - Content wrapped in semantic main element
    - pnpm build passes
  </done>
</task>

</tasks>

<verification>
- `pnpm build` passes
- TopBar has `hidden md:block` on bank name
- Layout has responsive padding `p-4 md:p-6`
- Layout has Suspense boundary with skeleton fallback
- Layout uses semantic `<main>` element
- No regression in existing sidebar/topbar functionality
</verification>

<success_criteria>
- NAV-02: Top bar displays user profile dropdown, language switcher, and notifications bell on all screen sizes
- NAV-03: Sidebar collapses to hamburger menu on mobile (Sheet overlay)
- Loading states show during navigation transitions
- Layout padding is responsive (p-4 on mobile, p-6 on desktop)
- All icon-only buttons have aria-labels
- No TypeScript errors, project builds cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-screens/02-05-SUMMARY.md`
</output>
