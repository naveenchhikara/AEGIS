---
phase: 02-core-screens
plan: 03
type: execute
wave: 2
depends_on: [02-01]
files_modified:
  - src/components/compliance/compliance-table.tsx
  - src/components/compliance/compliance-filter-bar.tsx
  - src/components/compliance/trend-chart.tsx
  - src/components/compliance/requirement-dialog.tsx
  - src/components/compliance/responsive-dialog.tsx
autonomous: false

must_haves:
  truths:
    - Compliance table displays 50+ requirements with sortable columns
    - Table is filterable by category and status
    - Status badges display with correct colors (green/yellow/red/gray)
    - Clicking requirement row opens detail modal
    - Detail modal shows full description and evidence list
    - Compliance trend chart renders with dummy data (last 6 months)
    - Filters use URL-based state management
  artifacts:
    - path: "src/components/compliance/compliance-table.tsx"
      provides: "Main compliance registry table with TanStack Table"
      exports: ["ComplianceDataTable", "columns"]
      contains: "column definitions with sorting, filtering"
    - path: "src/components/compliance/compliance-filter-bar.tsx"
      provides: "Filter controls for category and status"
      exports: ["ComplianceFilterBar"]
      contains: "URL-based filter state management"
    - path: "src/components/compliance/trend-chart.tsx"
      provides: "Line chart showing compliance trend over 6 months"
      exports: ["ComplianceTrendChart"]
      contains: "Recharts LineChart with trend data"
    - path: "src/components/compliance/requirement-dialog.tsx"
      provides: "Detail modal for requirement information"
      exports: ["RequirementDialog"]
      contains: "full requirement description and evidence list"
    - path: "src/components/compliance/responsive-dialog.tsx"
      provides: "Dialog on desktop, Drawer on mobile"
      exports: ["ResponsiveDialog"]
      contains: "useMediaQuery hook for component switching"
  key_links:
    - from: "src/components/compliance/compliance-table.tsx"
      to: "@tanstack/react-table"
      via: "useReactTable hook"
      pattern: "useReactTable"
    - from: "src/components/compliance/compliance-filter-bar.tsx"
      to: "next/navigation"
      via: "useSearchParams hook"
      pattern: "useSearchParams"
    - from: "src/components/compliance/trend-chart.tsx"
      to: "recharts"
      via: "LineChart import"
      pattern: "import.*LineChart.*from 'recharts'"
    - from: "src/components/compliance/compliance-table.tsx"
      to: "@/data/compliance-requirements"
      via: "data import"
      pattern: "complianceRequirements"
    - from: "src/components/compliance/responsive-dialog.tsx"
      to: "@/hooks/use-media-query"
      via: "useMediaQuery import"
      pattern: "useMediaQuery"
---

<objective>
Build compliance registry components: table with filters, trend chart, and detail modal.

Purpose: Create the compliance registry screen components per COMP-01 through COMP-06 requirements. Table uses TanStack Table for sorting/filtering, filters use URL-based state, trend chart uses Recharts, and detail modal uses responsive Dialog/Drawer pattern.

Output: Compliance registry components ready for page composition
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-core-screens/02-RESEARCH.md
@.planning/phases/02-core-screens/02-01-SUMMARY.md
@.planning/phases/01-project-setup/01-08-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create responsive dialog component</name>
  <files>src/components/compliance/responsive-dialog.tsx</files>
  <action>
    Create src/components/compliance/ directory and responsive-dialog.tsx:

    Add "use client" directive.

    Import: Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription from @/components/ui/dialog, Drawer, DrawerContent, DrawerHeader, DrawerTitle, DrawerDescription from @/components/ui/drawer, useMediaQuery from @/hooks/use-media-query

    Component features:
    - Props: open, onOpenChange, title, description?, children
    - Use useMediaQuery("(min-width: 768px)") to detect desktop
    - If desktop: render Dialog with max-w-[600px]
    - If mobile: render Drawer from bottom
    - Pass all props through to appropriate component
    - Handle close logic consistently

    Per RESEARCH.md Pattern 5 - Desktop gets modal, mobile gets drawer.

    Export: ResponsiveDialog component
  </action>
  <verify>Component exists with ResponsiveDialog export and useMediaQuery hook</verify>
  <done>Responsive dialog component created for desktop/mobile pattern</done>
</task>

<task type="auto">
  <name>Task 2: Create compliance filter bar with URL state</name>
  <files>src/components/compliance/compliance-filter-bar.tsx</files>
  <action>
    Create src/components/compliance/compliance-filter-bar.tsx:

    Add "use client" directive.

    Import: useSearchParams, useRouter, usePathname from 'next/navigation', Input, Select, SelectContent, SelectItem, SelectTrigger, SelectValue, Button from @/components/ui, ComplianceStatusBadge from @/lib/status-utils

    Component features:
    - Read category and status from useSearchParams()
    - Define category options: ['all', 'risk', 'governance', 'operations', 'it', 'credit', 'market-risk']
    - Define status options: ['all', 'compliant', 'partial', 'non-compliant', 'pending']
    - updateFilter function: uses URLSearchParams API to update URL
    - Clear filters button: removes all params
    - Category filter: Select dropdown
    - Status filter: Select dropdown
    - Search input: for requirement title/description

    Per RESEARCH.md Pattern 1 - URL-based state management.

    Export: ComplianceFilterBar component
  </action>
  <verify>Component uses useSearchParams and updates URL on filter change</verify>
  <done>Compliance filter bar created with URL-based state</done>
</task>

<task type="auto">
  <name>Task 3: Create TanStack Table for compliance requirements</name>
  <files>src/components/compliance/compliance-table.tsx</files>
  <action>
    Create src/components/compliance/compliance-table.tsx:

    Add "use client" directive.

    Import: ColumnDef, flexRender, getCoreRowModel, getFilteredRowModel, getSortedRowModel, useReactTable from '@tanstack/react-table', Table, TableBody, TableCell, TableHead, TableHeader, TableRow from @/components/ui/table, ArrowUpDown from lucide-react, Button from @/components/ui/button, type ComplianceRequirement from '@/types', ComplianceStatusBadge from @/lib/status-utils

    Column definitions:
    1. reference - sortable with ArrowUpDown button
    2. category - text display
    3. title - text display with truncate
    4. status - ComplianceStatusBadge component
    5. nextReview - sortable date display (formatted)
    6. evidenceCount - number display

    Component features:
    - useReactTable with sorting and filtering state
    - Filter data by category and status from URL params
    - Row click handler: opens detail dialog (passed as onRowClick prop)
    - Cursor pointer on rows for click affordance
    - Empty state when no results
    - Responsive overflow on small screens

    Per RESEARCH.md Pattern 4 - TanStack Table pattern.

    Export: ComplianceDataTable component with props: data, onRowClick
    Export: columns array for reuse
  </action>
  <verify>Component uses useReactTable and exports columns array</verify>
  <done>TanStack Table created for compliance registry with sorting and filtering</done>
</task>

<task type="auto">
  <name>Task 4: Create requirement detail dialog</name>
  <files>src/components/compliance/requirement-dialog.tsx</files>
  <action>
    Create src/components/compliance/requirement-dialog.tsx:

    Add "use client" directive.

    Import: ResponsiveDialog from ./responsive-dialog, Badge from @/components/ui/badge, Separator from @/components/ui/separator, Calendar, FileText, User icons from lucide-react, type ComplianceRequirement from '@/types', ComplianceStatusBadge from @/lib/status-utils

    Component features:
    - Props: requirement, open, onOpenChange
    - Dialog title: requirement.title or requirement.reference
    - Dialog sections:
      * Header: reference, category badge, status badge
      * Description: full requirement description
      * Reference: RBI circular reference
      * Due date: formatted date display
      * Assigned to: staff member name
      * Evidence count: number with FileText icon
      * Separator
      * Evidence list: placeholder array for now (empty or mock items)
    - Use ResponsiveDialog for desktop/mobile behavior

    Export: RequirementDialog component
  </action>
  <verify>Component uses ResponsiveDialog and displays all requirement fields</verify>
  <done>Requirement detail dialog created with full information display</done>
</task>

<task type="auto">
  <name>Task 5: Create compliance trend chart</name>
  <files>src/components/compliance/trend-chart.tsx</files>
  <action>
    Create src/components/compliance/trend-chart.tsx:

    Add "use client" directive.

    Import: LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer from 'recharts', Card, CardContent, CardHeader, CardTitle from @/components/ui/card

    Component features:
    - Props: data (array of { month: string, score: number })
    - Use dummy data for 6 months: Sep, Oct, Nov, Dec, Jan, Feb
    - Scores: 72, 75, 78, 82, 85, 88 (upward trend)
    - LineChart with ResponsiveContainer
    - XAxis: month labels
    - YAxis: 0-100 domain for score
    - CartesianGrid: dashed stroke-gray-200
    - Line: monotone type, primary color stroke, strokeWidth 2
    - Tooltip: styled with hsl variables for theming

    Per RESEARCH.md Pattern 3 - Line chart example.

    Export: ComplianceTrendChart component
  </action>
  <verify>Component uses Recharts LineChart and accepts trend data prop</verify>
  <done>Compliance trend chart created with 6-month visualization</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Compliance registry components: filter bar, data table, detail dialog, trend chart</what-built>
  <how-to-verify>
    Note: Components are created but not yet rendered on page. This checkpoint verifies component structure.

    1. Check all component files exist in src/components/compliance/
    2. Verify TypeScript compiles: npx tsc --noEmit
    3. Verify no import errors
    4. Check component exports:
       - compliance-filter-bar.tsx exports ComplianceFilterBar
       - compliance-table.tsx exports ComplianceDataTable, columns
       - requirement-dialog.tsx exports RequirementDialog
       - trend-chart.tsx exports ComplianceTrendChart
       - responsive-dialog.tsx exports ResponsiveDialog

    Components should:
    - All have "use client" directive
    - Table uses TanStack Table with useReactTable
    - Filter bar uses useSearchParams for URL state
    - Trend chart uses Recharts LineChart
    - Detail dialog uses ResponsiveDialog wrapper
  </how-to-verify>
  <resume-signal>Type "approved" if all compliance components are created and compile, or describe issues</resume-signal>
</task>

</tasks>

<verification>
- All 5 component files exist in src/components/compliance/
- ResponsiveDialog uses useMediaQuery hook for desktop/mobile switching
- ComplianceFilterBar uses useSearchParams for URL-based state
- ComplianceDataTable uses TanStack Table with useReactTable
- Table has sortable columns (reference, nextReview)
- Table filters by category and status
- RequirementDialog displays all requirement fields
- ComplianceTrendChart uses Recharts LineChart
- TypeScript compiles without errors
</verification>

<success_criteria>
- 5 compliance components created
- URL-based filter state management implemented
- TanStack Table with sorting and filtering
- Responsive dialog pattern for detail views
- Trend chart with 6-month dummy data
- All components connect to ComplianceRequirement types
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-screens/02-03-SUMMARY.md`
</output>
