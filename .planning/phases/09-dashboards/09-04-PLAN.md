---
phase: 09-dashboards
plan: 04
type: execute
wave: 2
depends_on: [09-01, 09-02]
files_modified:
  - src/components/dashboard/widgets/my-observations-table.tsx
  - src/components/dashboard/widgets/engagement-progress.tsx
  - src/components/dashboard/widgets/pending-responses.tsx
  - src/components/dashboard/widgets/team-workload-chart.tsx
  - src/components/dashboard/widgets/pending-reviews-table.tsx
  - src/components/dashboard/widgets/branch-risk-heatmap.tsx
  - src/components/dashboard/widgets/board-report-readiness.tsx
  - src/components/dashboard/widgets/regulatory-calendar.tsx
  - src/components/dashboard/widgets/compliance-tasks.tsx
  - src/components/dashboard/widgets/rbi-circular-impact.tsx
  - src/components/dashboard/widgets/risk-indicators.tsx
  - src/components/dashboard/widgets/pca-status-badge.tsx
  - src/components/dashboard/widgets/key-trends-sparklines.tsx
autonomous: true

must_haves:
  truths:
    - "Auditor widgets: my-observations-table (top 10, sortable), engagement-progress (progress bars), pending-responses (count + list)"
    - "Manager widgets: team-workload-chart (bar per auditor), pending-reviews-table (SUBMITTED observations)"
    - "CAE widgets: branch-risk-heatmap (color-coded risk by branch), board-report-readiness (section checklist)"
    - "CCO widgets: regulatory-calendar (upcoming deadlines), compliance-tasks (progress by category), rbi-circular-impact (circular counts)"
    - "CEO widgets: risk-indicators (critical/overdue/non-compliant counts), pca-status-badge, key-trends-sparklines (6-month mini charts)"
    - "All widgets accept data via props and handle empty state"
  artifacts:
    - path: src/components/dashboard/widgets/my-observations-table.tsx
      provides: Auditor's assigned observations table (top 10, sortable)
      min_lines: 40
      contains: "MyObservationsTable"
    - path: src/components/dashboard/widgets/team-workload-chart.tsx
      provides: Manager's team workload horizontal bar chart
      min_lines: 30
      contains: "TeamWorkloadChart"
    - path: src/components/dashboard/widgets/branch-risk-heatmap.tsx
      provides: CAE's branch risk table with color-coded scores
      min_lines: 40
      contains: "BranchRiskHeatmap"
    - path: src/components/dashboard/widgets/regulatory-calendar.tsx
      provides: CCO's upcoming compliance deadline timeline
      min_lines: 30
      contains: "RegulatoryCalendar"
    - path: src/components/dashboard/widgets/risk-indicators.tsx
      provides: CEO's risk status card with counts
      min_lines: 25
      contains: "RiskIndicators"
  key_links:
    - from: All widgets
      to: src/data-access/dashboard.ts
      via: Data passed as props from SSR or React Query polling
      pattern: "props"
    - from: Table widgets
      to: src/components/ui/table.tsx
      via: shadcn Table component for consistent styling
      pattern: "Table"
---

<objective>
Build all 13 role-specific dashboard widgets: 3 for Auditor, 2 for Manager, 2 for CAE, 3 for CCO, and 3 for CEO.

Purpose: Each role gets specialized widgets showing data relevant to their responsibilities. Auditors see personal assignments, Managers see team workload, CAE sees institutional risk, CCO sees compliance deadlines, and CEO sees executive KPIs. All widgets accept data via props.

Output: 13 role-specific widget components.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-dashboards/09-PLAN.md
@src/components/dashboard/
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Auditor and Manager dashboard widgets</name>
  <files>src/components/dashboard/widgets/my-observations-table.tsx, src/components/dashboard/widgets/engagement-progress.tsx, src/components/dashboard/widgets/pending-responses.tsx, src/components/dashboard/widgets/team-workload-chart.tsx, src/components/dashboard/widgets/pending-reviews-table.tsx</files>
  <action>
**Auditor widgets (DASH-01):**

**1. my-observations-table.tsx:**

- Props: `observations: Array<{ id, title, severity, status, branchName, dueDate }>`
- shadcn Table: columns for Title, Severity (badge), Status (badge), Branch, Due Date
- Sortable by severity or due date
- Max 10 rows, "View all" link to /findings
- Empty: "No observations assigned yet"

**2. engagement-progress.tsx:**

- Props: `engagements: Array<{ id, name, status, totalObservations, completedObservations }>`
- Progress bars per engagement (completed/total)
- Status badge (IN_PROGRESS, COMPLETED, etc.)
- Empty: "No active engagements"

**3. pending-responses.tsx:**

- Props: `count: number; items: Array<{ id, title, branchName, issuedDate }>`
- Count card at top + compact list below
- Shows observations in ISSUED status awaiting auditee response
- Empty: "All observations have responses" (green checkmark)

**Manager widgets (DASH-02):**

**4. team-workload-chart.tsx:**

- Props: `auditors: Array<{ auditorName, totalAssigned, openCount, highCriticalOpen }>`
- Recharts horizontal BarChart: one bar per auditor
- Color segments: high/critical (red/orange) vs other (blue)
- Empty: "No auditors assigned"

**5. pending-reviews-table.tsx:**

- Props: `reviews: Array<{ id, title, severity, auditorName, submittedDate }>`
- shadcn Table: observations in SUBMITTED status awaiting manager review
- Max 10 rows, "View all" link
- Empty: "No pending reviews"
  </action>
  <verify>Run `pnpm build`. Verify all 5 widgets accept typed props. Verify tables use shadcn components. Verify empty states.</verify>
  <done>Auditor widgets (observations, engagements, pending responses) and Manager widgets (workload, reviews).</done>
  </task>

<task type="auto">
  <name>Task 2: Create CAE and CCO dashboard widgets</name>
  <files>src/components/dashboard/widgets/branch-risk-heatmap.tsx, src/components/dashboard/widgets/board-report-readiness.tsx, src/components/dashboard/widgets/regulatory-calendar.tsx, src/components/dashboard/widgets/compliance-tasks.tsx, src/components/dashboard/widgets/rbi-circular-impact.tsx</files>
  <action>
**CAE widgets (DASH-03):**

**1. branch-risk-heatmap.tsx:**

- Props: `branches: Array<{ id, name, openCount, criticalCount, highCount, riskScore }>`
- shadcn Table with color-coded risk column (green/amber/red/dark-red based on riskScore)
- Sorted by riskScore descending (highest risk first)
- Full width
- Empty: "No branch data available"

**2. board-report-readiness.tsx:**

- Props: `sections: Array<{ section, isReady, missingData? }>`
- Checklist UI: green check / red X per board report section
- Sections: Executive Summary, Audit Coverage, Key Findings, Compliance Scorecard, Recommendations
- Shows what's missing for incomplete sections
- CTA: "Generate Board Report" link to /reports

**CCO widgets (DASH-04):**

**3. regulatory-calendar.tsx:**

- Props: `deadlines: Array<{ id, requirement, category, nextReviewDate }>`
- Timeline/list sorted by date (soonest first)
- Color urgency: ≤7 days (red), ≤30 days (amber), >30 days (green)
- Empty: "No upcoming deadlines"

**4. compliance-tasks.tsx:**

- Props: `categories: Array<{ category, total, compliant, partial, nonCompliant, pending }>`
- Progress bars per category showing completion percentage
- Color segments matching compliance status colors
- Full width

**5. rbi-circular-impact.tsx:**

- Props: `circulars: Array<{ id, circularNumber, title, issuedDate, linkedRequirementCount }>`
- shadcn Table: recent RBI circulars with count of linked compliance requirements
- Max 10 rows
- Empty: "No recent circulars"
  </action>
  <verify>Run `pnpm build`. Verify branch heatmap sorts by risk score. Verify regulatory calendar has urgency colors. Verify board readiness shows checklist.</verify>
  <done>CAE widgets (branch heatmap, board readiness) and CCO widgets (calendar, tasks, circular impact).</done>
  </task>

<task type="auto">
  <name>Task 3: Create CEO dashboard widgets</name>
  <files>src/components/dashboard/widgets/risk-indicators.tsx, src/components/dashboard/widgets/pca-status-badge.tsx, src/components/dashboard/widgets/key-trends-sparklines.tsx</files>
  <action>
**CEO widgets (DASH-05):**

**1. risk-indicators.tsx:**

- Props: `data: { criticalFindings: number; overdueItems: number; nonCompliantCount: number }`
- Card with 3 status indicators
- Each shows count + label with color coding (red if >0, green if 0)
- Icon per indicator (AlertTriangle, Clock, XCircle)

**2. pca-status-badge.tsx:**

- Props: `status: string | null` (NONE, PCA1, PCA2, PCA3)
- Color-coded badge: NONE=green, PCA1=amber, PCA2=orange, PCA3=red
- If null: "Not configured" (gray)
- Tooltip explaining PCA levels

**3. key-trends-sparklines.tsx:**

- Props: `trends: { healthScore: number[]; compliancePercentage: number[]; findingCount: number[] }` (6-month arrays)
- 3 mini line charts (sparklines) using Recharts LineChart with minimal UI
- Each shows trend direction arrow (up/down) + percentage change
- If insufficient data: "Trend data available after first quarter"
  </action>
  <verify>Run `pnpm build`. Verify risk indicators show 3 metrics with color coding. Verify PCA badge handles null and all 4 statuses. Verify sparklines handle insufficient data.</verify>
  <done>CEO widgets: risk indicators, PCA status badge, key trends sparklines.</done>
  </task>

</tasks>

<verification>
1. `pnpm build` succeeds
2. Auditor: my-observations-table shows top 10 with sort
3. Auditor: engagement-progress shows progress bars
4. Manager: team-workload-chart shows bar per auditor
5. Manager: pending-reviews-table shows SUBMITTED observations
6. CAE: branch-risk-heatmap color-codes by risk score
7. CAE: board-report-readiness shows section checklist
8. CCO: regulatory-calendar shows upcoming deadlines with urgency
9. CCO: compliance-tasks shows progress per category
10. CEO: risk-indicators shows 3 color-coded counts
11. CEO: pca-status-badge handles null and all PCA levels
12. CEO: sparklines show 6-month trends
13. All 13 widgets handle empty state
</verification>

<success_criteria>

- Auditor dashboard widgets ready (DASH-01)
- Audit Manager dashboard widgets ready (DASH-02)
- CAE dashboard widgets ready (DASH-03)
- CCO dashboard widgets ready (DASH-04)
- CEO dashboard widgets ready (DASH-05)
- All widgets accept props and handle empty data
  </success_criteria>

<output>
After completion, create `.planning/phases/09-dashboards/09-04-SUMMARY.md`
</output>
